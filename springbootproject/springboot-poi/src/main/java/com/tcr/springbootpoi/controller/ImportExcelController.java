package com.tcr.springbootpoi.controller;import com.tcr.springbootpoi.service.ImportExcelService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.multipart.MultipartFile;import org.springframework.web.multipart.MultipartHttpServletRequest;import javax.servlet.http.HttpServletRequest;import java.io.InputStream;import java.util.List;@Controllerpublic class ImportExcelController {    @Autowired    private ImportExcelService importExcelService;    @GetMapping("/upload")    @ResponseBody    public String uploadExcel(HttpServletRequest request) throws Exception{        MultipartHttpServletRequest multipartRequest = (MultipartHttpServletRequest) request;        MultipartFile multipartFile = multipartRequest.getFile("filename");        if (multipartFile.isEmpty()){            return "上传的文件不能为空!";        }        //获取文件读取流        InputStream inputStream = multipartFile.getInputStream();        //处理上传的文件        List<List<Object>> list = importExcelService.getBankListByExcel(inputStream,"filename");        //关闭文件读取流        inputStream.close();        for (int i=0;i<list.size();i++){            List<Object> lo = list.get(i);            //业务处理代码            System.out.println("lo:"+lo);        }        return "上传成功!";    }}